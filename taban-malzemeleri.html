<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taban Malzemeleri</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <!-- Header kısmını ana sayfadan kopyalayın -->
        <div class="nav-bar">
            <div class="logo">
                <img src="img/menu-icon.png" alt="Menu Icon" id="menu-toggle">
                <a href="index.html"> 
                    <img src="img/logo.png" alt="Logo" class="logo-image">
                </a>
            </div>
            <div class="search-bar">
                
                <div style="position: relative;">
                    <input type="text" id="search-bar" placeholder="Ayakkabıya dair ihtiyacınız olan her şey..." style="width: 300%; padding: 10px; " >
                    <div id="search-results" style="display: none;"></div>
                </div>
                
                </div>
       
                <script>
                    const searchInput = document.getElementById("search-bar");
                    const resultsContainer = document.getElementById("search-results");
                    let products = []; // Ürünleri API'den çekeceğiz
                
                    // API'den ürünleri çek
                    async function fetchProducts() {
                        try {
                            const response = await fetch("http://localhost:3000/api/urunler");
                            if (!response.ok) throw new Error("Ürünleri çekme sırasında bir hata oluştu.");
                            products = await response.json(); // Ürünleri al ve global değişkene ata
                        } catch (error) {
                            console.error("API bağlantı hatası:", error);
                        }
                    }
                
                    // Arama çubuğunda input etkinliği dinle
                    searchInput.addEventListener("input", (e) => {
                        const query = e.target.value.toLowerCase(); // Kullanıcı girdisini al
                        resultsContainer.innerHTML = ""; // Eski sonuçları temizle
                        resultsContainer.style.display = query ? "block" : "none"; // Arama çubuğu boşsa gizle
                
                        // Ürünleri filtrele ve sonuçları listele
                        const filteredProducts = products.filter(product =>
                            product.name.toLowerCase().includes(query)
                        );
                
                        if (filteredProducts.length === 0) {
                            resultsContainer.innerHTML = "<p style='padding: 10px;'>Sonuç bulunamadı.</p>";
                            return;
                        }
                
                        filteredProducts.forEach(product => {
                            const productElement = document.createElement("div");
                            productElement.style.padding = "10px";
                            productElement.style.borderBottom = "1px solid #ddd";
                            productElement.innerHTML = `
                                <a href="taban-malzemeleri-detay.html?id=${product.id} style="text-decoration: none; color: #333;">
                                    <strong>${product.name}</strong> - ₺${product.price}
                                </a>
                            `;
                            resultsContainer.appendChild(productElement);
                        });
                    });
                
                    // Sayfa yüklendiğinde ürünleri API'den çek
                    document.addEventListener("DOMContentLoaded", fetchProducts);
                </script>
    
å    





           <div class="user-actions">
    <!-- Giriş Yap/Kayıt Ol -->
    <div class="action-item">
        <img src="img/user.png" alt="Sign In Icon" class="icon">
        <a href="#">Giriş Yap/Kayıt Ol</a>
    </div>
    
    <!-- Sepet -->
    <div class="action-item">
        <img src="img/cart.svg" alt="Cart Icon" class="icon" id="cart-icon">
        <a href="javascript:void(0)" id="cart-link">Sepet</a>
    </div>
</div>

<!-- Sepet Modal -->
<div id="cart-modal" class="cart-modal">
    <div id="cart-list" class="cart-list">
        <!-- Sepet öğeleri burada listelenecek -->
    </div>
</div>

            
        </div>

        <!-- Yan Menü -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <span id="close-sidebar" class="close-btn">X</span>
            </div>
            <ul>
                <li><a href="taban-malzemeleri.html"><img src="icons/shoe_sole.png" alt="Taban Malzemeleri" class="sidebar-icon">Taban Malzemeleri</a></li>
                <li><a href="saya-malzemeleri.html"><img src="icons/shoeico.png" alt="Saya Malzemeleri" class="sidebar-icon">Saya Malzemeleri</a></li>
                <li><a href="bagcik-malzemeleri.html"><img src="icons/lase.png" alt="Bağcıklar" class="sidebar-icon">Bağcıklar</a></li>
                <li><a href="yapistirici-malzemeleri.html"><img src="icons/glue.png" alt="Yapıştırıcılar ve Kimyasallar" class="sidebar-icon">Yapıştırıcılar ve Kimyasallar</a></li>
                <li><a href="aksesuar.html"><img src="icons/aksesuar.png" alt="Aksesuarlar" class="sidebar-icon">Aksesuarlar</a></li>
                <li><a href="boya.html"><img src="icons/polish.png" alt="Boyalar" class="sidebar-icon">Boyalar</a></li>
            </ul>
        </nav>
    </header>

    <!-- Kategoriler -->
    <nav class="categories">
        <button onclick="window.location.href='taban-malzemeleri.html'">Taban Malzemeleri</button>
        <button onclick="window.location.href='saya-malzemeleri.html'">Saya Malzemeleri</button>
        <button onclick="window.location.href='bagcik-malzemeleri.html'">Bağcıklar</button>
        <button onclick="window.location.href='yapistirici-malzemeleri.html'">Yapıştırıcı Ve Kimyasallar</button>
        <button onclick="window.location.href='aksesuar.html'">Aksesuarlar</button>
        <button onclick="window.location.href='boya.html'">Boyalar</button>
    </nav>

    <section class="shoe-paint-section">
        <h2 class="title-shoe-paints">Taban Malzemeleri</h2>
        <p class="description-shoe-paints">Ayakkabılarınızın tabanlarını güçlendirin ve uzun ömürlü hale getirin! Farklı malzeme seçenekleriyle taban malzemelerimizi keşfedin.</p>
        <div id="product-list" class="product-list"></div>
    </section>

    <script>
        // Menü simgesi tıklama işlevi
        document.getElementById("menu-toggle").addEventListener("click", function() {
            const sidebar = document.getElementById("sidebar");
            sidebar.classList.toggle("open");
        });

        // Sidebar'ı kapatmak için "X" butonuna tıklama işlevi
        document.getElementById("close-sidebar").addEventListener("click", function() {
            const sidebar = document.getElementById("sidebar");
            sidebar.classList.remove("open");
        });

        // fetchTabanMalzemeleri fonksiyonu
        async function fetchTabanMalzemeleri() {
            try {
                const response = await fetch("http://localhost:3000/api/taban-malzemeleri");
                if (!response.ok) {
                    throw new Error("Ürünler getirilemedi");
                }

                const products = await response.json();
                const productList = document.getElementById("product-list");

                if (products.length === 0) {
                    productList.innerHTML = '<p>Ürün bulunamadı.</p>';
                    return;
                }

                products.forEach((product) => {
                    const productCard = document.createElement("div");
                    productCard.classList.add("product-card");

                    productCard.innerHTML = `
                    <div class="product-card">
                        <div class="product-image-container">
                            <img src="${product.image_url}" alt="${product.name}" class="product-image">
                        </div>
                        <div class="product-info">
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-description">${product.description}</p>
                            <p class="product-price">${product.price} TL</p>
                            <p class="product-rating">${"⭐".repeat(product.rating || 0)}</p>
                            <button class="add-to-cart">Sepete Ekle</button>
                        </div>
                    </div>
                    `;

                    // Ürün kartına tıklanabilirlik ekleme
                    productCard.addEventListener("click", () => {
                        window.location.href = `taban-malzemeleri-detay.html?id=${product.id}`; // Detay sayfasına yönlendirme
                    });

                    productList.appendChild(productCard);
                });
            } catch (error) {
                console.error("Veriler çekilirken hata oluştu:", error);
            }
        }

        // Sayfa yüklendiğinde fetch fonksiyonunu çalıştır
        document.addEventListener("DOMContentLoaded", fetchTabanMalzemeleri);
    </script>
</body>
</html>
